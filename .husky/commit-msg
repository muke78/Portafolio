#!/bin/sh
echo "ğŸ” Validando mensaje de commit..."

# ExpresiÃ³n regular mejorada:
# tipo(scope opcional): descripciÃ³n mÃ­nima de 10 caracteres
# git commit -m "feat(funcionalidad): "Nueva funcionalidad para el sistema"
commit_regex="^(feat|fix|docs|style|refactor|perf|test|chore|ci|build|revert)(\([a-zA-Z0-9_-]+\))?: ?.{10,}$"
commit_msg=$(cat "$1")

if ! echo "$commit_msg" | grep -Eq "$commit_regex"; then
  echo ""
  echo "âŒ Mensaje de commit invÃ¡lido."
  echo "--------------------------------------------------"
  echo "ğŸ“Œ Formato esperado: 'tipo(scope opcional): descripciÃ³n de al menos 10 caracteres'"
  echo "ğŸ”§ Tipos vÃ¡lidos:"
  echo "   feat     â†’ Nueva funcionalidad"
  echo "   fix      â†’ CorrecciÃ³n de errores"
  echo "   docs     â†’ Cambios en documentaciÃ³n"
  echo "   style    â†’ Formato, estilo, sin afectar cÃ³digo"
  echo "   refactor â†’ RefactorizaciÃ³n de cÃ³digo"
  echo "   perf     â†’ Mejora de rendimiento"
  echo "   test     â†’ Agregar o corregir pruebas"
  echo "   chore    â†’ Tareas generales o mantenimiento"
  echo "   ci       â†’ Cambios en configuraciÃ³n CI/CD"
  echo "   build    â†’ Cambios que afectan el build"
  echo "   revert   â†’ Revertir un commit"
  echo ""
  echo "ğŸ“ Ejemplos vÃ¡lidos:"
  echo "   feat: Agregar login con Google"
  echo "   fix(auth): Corregir error al refrescar token"
  echo "--------------------------------------------------"
  exit 1
fi

echo "âœ… Mensaje vÃ¡lido. Â¡Buen trabajo! ğŸš€"